<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe Técnico Completo - Sistema Gestor Dental</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.7;
            color: #2c3e50;
            background: #f8f9fa;
            font-size: 14px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            page-break-inside: avoid;
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .section h3 {
            color: #34495e;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
        }

        .section h4 {
            color: #2c3e50;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }

        .diagram {
            background: #f8f9fa;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-family: 'Courier New', monospace;
        }

        .uml-diagram {
            background: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tech-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .tech-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .tech-card h4 {
            color: #3498db;
            margin-bottom: 10px;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            background: #f8f9fa;
            margin: 8px 0;
            padding: 12px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 13px;
        }

        .table th, .table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .table th {
            background: #3498db;
            color: white;
            font-weight: bold;
        }

        .table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        .toc {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .toc ul {
            list-style: none;
            padding-left: 20px;
        }

        .toc li {
            margin: 8px 0;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
        }

        @media print {
            .container {
                box-shadow: none;
            }
            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Sistema Gestor Dental</h1>
            <p class="subtitle">Informe Técnico Completo - Versión sin Módulos de IA</p>
            <p><strong>Fecha:</strong> Diciembre 2024 | <strong>Versión:</strong> 1.0</p>
        </div>

        <div class="content">
            <!-- Tabla de Contenidos -->
            <div class="section">
                <h2>Índice</h2>
                <div class="toc">
                    <ul>
                        <li><a href="#resumen">1. Resumen Ejecutivo</a></li>
                        <li><a href="#arquitectura">2. Arquitectura del Sistema</a></li>
                        <li><a href="#tecnologias">3. Stack Tecnológico Detallado</a></li>
                        <li><a href="#supabase">4. Supabase: Backend-as-a-Service</a></li>
                        <li><a href="#react">5. React.js: Frontend Framework</a></li>
                        <li><a href="#base-datos">6. Base de Datos y Modelado</a></li>
                        <li><a href="#funcionalidades">7. Funcionalidades del Sistema</a></li>
                        <li><a href="#seguridad">8. Seguridad y Autenticación</a></li>
                        <li><a href="#api">9. API y Endpoints</a></li>
                        <li><a href="#despliegue">10. Despliegue y Configuración</a></li>
                    </ul>
                </div>
            </div>

            <!-- Resumen Ejecutivo -->
            <div class="section" id="resumen">
                <h2>1. Resumen Ejecutivo</h2>
                <p>El Sistema Gestor Dental es una aplicación web moderna desarrollada para la gestión integral de clínicas dentales. El sistema proporciona herramientas completas para la administración de pacientes, citas, historiales médicos y odontogramas, implementando las mejores prácticas de desarrollo web moderno.</p>
                
                <h3>1.1 Objetivos del Sistema</h3>
                <ul class="feature-list">
                    <li>Digitalizar la gestión de pacientes y citas médicas</li>
                    <li>Proporcionar un sistema de autenticación seguro</li>
                    <li>Gestionar historiales médicos completos</li>
                    <li>Implementar odontogramas digitales</li>
                    <li>Facilitar la gestión de archivos médicos</li>
                </ul>

                <h3>1.2 Alcance del Proyecto</h3>
                <p>El sistema cubre todos los aspectos de la gestión dental, desde el registro de pacientes hasta el seguimiento de tratamientos, excluyendo funcionalidades de inteligencia artificial que se implementan en versiones posteriores.</p>
            </div>

            <!-- Arquitectura del Sistema -->
            <div class="section" id="arquitectura">
                <h2>2. Arquitectura del Sistema</h2>
                
                <h3>2.1 Arquitectura General</h3>
                <div class="diagram">
                    <h4>Diagrama de Arquitectura del Sistema</h4>
                    <pre>
┌─────────────────────────────────────────────────────────────┐
│                    PRESENTATION LAYER                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐ │
│  │   React SPA     │  │   Chakra UI     │  │   Vite Dev   │ │
│  │   Components    │  │   Components    │  │   Server     │ │
│  └─────────────────┘  └─────────────────┘  └──────────────┘ │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    APPLICATION LAYER                        │
│  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐ │
│  │   Express.js    │  │   React Router  │  │   React      │ │
│  │   Server        │  │   Navigation    │  │   Hooks      │ │
│  └─────────────────┘  └─────────────────┘  └──────────────┘ │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    DATA LAYER                               │
│  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐ │
│  │   Supabase      │  │   PostgreSQL    │  │   Row Level  │ │
│  │   Client        │  │   Database      │  │   Security   │ │
│  └─────────────────┘  └─────────────────┘  └──────────────┘ │
└─────────────────────────────────────────────────────────────┘
                    </pre>
                </div>

                <h3>2.2 Diagrama de Casos de Uso</h3>
                <div class="uml-diagram">
                    <h4>Casos de Uso del Sistema</h4>
                    <pre>
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│    Dentista     │    │    Paciente     │    │   Administrador │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────────────────────────────────────────────────────┐
│                        SISTEMA DENTAL                           │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────┐ │
│  │ Gestionar   │  │ Ver Perfil  │  │ Autenticar  │  │ Config  │ │
│  │ Pacientes   │  │ Personal    │  │ Usuarios    │  │ Sistema │ │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────┘ │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────┐ │
│  │ Gestionar   │  │ Ver Citas   │  │ Gestionar   │  │ Crear   │ │
│  │ Citas       │  │ Propias     │  │ Archivos    │  │ Reportes│ │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────┘ │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────┐ │
│  │ Crear       │  │ Ver         │  │ Gestionar   │  │ Exportar│ │
│  │ Odontogramas│  │ Historial   │  │ Consultas   │  │ Datos   │ │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────┘
                    </pre>
                </div>

                <h3>2.3 Flujo de Datos</h3>
                <div class="diagram">
                    <h4>Diagrama de Secuencia - Autenticación</h4>
                    <pre>
Usuario    Frontend    Backend    Supabase    Base de Datos
  │           │           │           │           │
  │──Login───▶│           │           │           │
  │           │──Auth────▶│           │           │
  │           │           │──Validate▶│           │
  │           │           │           │──Query────▶│
  │           │           │           │◀──Data────│
  │           │           │◀──Token───│           │
  │           │◀──JWT────│           │           │
  │◀──Access──│           │           │           │
                    </pre>
                </div>
            </div>

            <!-- Stack Tecnológico -->
            <div class="section" id="tecnologias">
                <h2>3. Stack Tecnológico Detallado</h2>
                
                <div class="tech-grid">
                    <div class="tech-card">
                        <h4>Frontend - React.js 18.2.0</h4>
                        <p><strong>Descripción:</strong> Biblioteca de JavaScript para construir interfaces de usuario</p>
                        <p><strong>Características:</strong></p>
                        <ul>
                            <li>Componentes reutilizables</li>
                            <li>Virtual DOM para rendimiento</li>
                            <li>Hooks para estado y efectos</li>
                            <li>JSX para sintaxis declarativa</li>
                        </ul>
                    </div>

                    <div class="tech-card">
                        <h4>Build Tool - Vite 5.4.0</h4>
                        <p><strong>Descripción:</strong> Herramienta de construcción moderna para desarrollo web</p>
                        <p><strong>Ventajas:</strong></p>
                        <ul>
                            <li>Hot Module Replacement (HMR)</li>
                            <li>Build optimizado con Rollup</li>
                            <li>Configuración mínima</li>
                            <li>Desarrollo ultra-rápido</li>
                        </ul>
                    </div>

                    <div class="tech-card">
                        <h4>UI Framework - Chakra UI 2.8.2</h4>
                        <p><strong>Descripción:</strong> Biblioteca de componentes accesibles para React</p>
                        <p><strong>Características:</strong></p>
                        <ul>
                            <li>Componentes accesibles (WCAG)</li>
                            <li>Sistema de diseño consistente</li>
                            <li>Modo oscuro/claro</li>
                            <li>Responsive por defecto</li>
                        </ul>
                    </div>

                    <div class="tech-card">
                        <h4>Backend - Express.js 4.19.2</h4>
                        <p><strong>Descripción:</strong> Framework web minimalista para Node.js</p>
                        <p><strong>Funcionalidades:</strong></p>
                        <ul>
                            <li>Middleware personalizable</li>
                            <li>Routing flexible</li>
                            <li>Manejo de errores</li>
                            <li>Integración con APIs externas</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Supabase -->
            <div class="section" id="supabase">
                <h2>4. Supabase: Backend-as-a-Service</h2>
                
                <h3>4.1 ¿Qué es Supabase?</h3>
                <p>Supabase es una alternativa de código abierto a Firebase que proporciona una base de datos PostgreSQL, autenticación, APIs en tiempo real y almacenamiento de archivos.</p>

                <h3>4.2 Funcionalidades Utilizadas</h3>
                <div class="tech-grid">
                    <div class="tech-card">
                        <h4>Base de Datos PostgreSQL</h4>
                        <ul>
                            <li>Base de datos relacional robusta</li>
                            <li>SQL completo y transacciones</li>
                            <li>Índices y optimización</li>
                            <li>Backups automáticos</li>
                        </ul>
                    </div>

                    <div class="tech-card">
                        <h4>Autenticación</h4>
                        <ul>
                            <li>JWT tokens seguros</li>
                            <li>Múltiples proveedores (email, Google, etc.)</li>
                            <li>Gestión de sesiones</li>
                            <li>Políticas de contraseñas</li>
                        </ul>
                    </div>

                    <div class="tech-card">
                        <h4>Row Level Security (RLS)</h4>
                        <ul>
                            <li>Control granular de acceso</li>
                            <li>Políticas por usuario/rol</li>
                            <li>Seguridad a nivel de fila</li>
                            <li>Auditoría de acceso</li>
                        </ul>
                    </div>

                    <div class="tech-card">
                        <h4>APIs Automáticas</h4>
                        <ul>
                            <li>REST API automática</li>
                            <li>GraphQL opcional</li>
                            <li>Subscripciones en tiempo real</li>
                            <li>Filtros y paginación</li>
                        </ul>
                    </div>
                </div>

                <h3>4.3 Configuración en el Proyecto</h3>
                <div class="code-block">
// Configuración del cliente Supabase
import { createClient } from '@supabase/supabase-js'

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY

export const supabase = createClient(supabaseUrl, supabaseAnonKey, {
  auth: {
    autoRefreshToken: true,
    persistSession: true,
    detectSessionInUrl: true
  }
})

// Ejemplo de uso
const { data, error } = await supabase
  .from('patients')
  .select('*')
  .eq('dentist_id', user.id)
                </div>
            </div>

            <!-- React -->
            <div class="section" id="react">
                <h2>5. React.js: Frontend Framework</h2>
                
                <h3>5.1 Arquitectura de Componentes</h3>
                <div class="diagram">
                    <h4>Estructura de Componentes React</h4>
                    <pre>
App.jsx (Root Component)
├── Layout.jsx (Layout Principal)
│   ├── Navigation.jsx
│   └── Sidebar.jsx
├── RouteGuard.jsx (Protección de Rutas)
├── Pages/
│   ├── Dashboard.jsx
│   ├── Patients.jsx
│   ├── PatientDetail.jsx
│   ├── Agenda.jsx
│   └── Settings.jsx
└── Components/
    ├── Calendar.jsx
    ├── Odontogram.jsx
    ├── FileUploader.jsx
    └── ConsultationManager.jsx
                    </pre>
                </div>

                <h3>5.2 Hooks Personalizados</h3>
                <div class="code-block">
// Hook para gestión de Supabase
export const useSupabase = () => {
  const [user, setUser] = useState(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    // Obtener sesión actual
    supabase.auth.getSession().then(({ data: { session } }) => {
      setUser(session?.user ?? null)
      setLoading(false)
    })

    // Escuchar cambios de autenticación
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      (event, session) => {
        setUser(session?.user ?? null)
        setLoading(false)
      }
    )

    return () => subscription.unsubscribe()
  }, [])

  return { user, loading }
}

// Hook para redirección basada en roles
export const useRoleRedirect = () => {
  const { user } = useSupabase()
  const navigate = useNavigate()

  useEffect(() => {
    if (user) {
      const { data: profile } = await supabase
        .from('profiles')
        .select('role')
        .eq('id', user.id)
        .single()

      if (profile?.role === 'patient') {
        navigate('/patient-dashboard')
      } else {
        navigate('/dashboard')
      }
    }
  }, [user])
}
                </div>

                <h3>5.3 Gestión de Estado</h3>
                <p>El sistema utiliza React Hooks para la gestión de estado local:</p>
                <ul class="feature-list">
                    <li><strong>useState:</strong> Estado local de componentes</li>
                    <li><strong>useEffect:</strong> Efectos secundarios y suscripciones</li>
                    <li><strong>useContext:</strong> Estado global compartido</li>
                    <li><strong>useReducer:</strong> Estado complejo con lógica</li>
                </ul>
            </div>

            <!-- Base de Datos -->
            <div class="section" id="base-datos">
                <h2>6. Base de Datos y Modelado</h2>
                
                <h3>6.1 Diagrama Entidad-Relación</h3>
                <div class="uml-diagram">
                    <h4>Modelo de Datos</h4>
                    <pre>
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│    profiles     │    │    patients     │    │  appointments   │
├─────────────────┤    ├─────────────────┤    ├─────────────────┤
│ id (PK)         │    │ id (PK)         │    │ id (PK)         │
│ full_name       │    │ name            │    │ patient_id (FK) │
│ role            │    │ email           │    │ date            │
│ created_at      │    │ phone           │    │ time            │
└─────────────────┘    └─────────────────┘    │ status          │
         │                       │            └─────────────────┘
         │                       │                       │
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│  consultations  │    │   odontograms   │    │     files       │
├─────────────────┤    ├─────────────────┤    ├─────────────────┤
│ id (PK)         │    │ id (PK)         │    │ id (PK)         │
│ patient_id (FK) │    │ patient_id (FK) │    │ patient_id (FK) │
│ date            │    │ chart_data      │    │ file_name       │
│ diagnosis       │    │ created_at      │    │ file_path       │
│ treatment       │    └─────────────────┘    │ file_type       │
└─────────────────┘                           └─────────────────┘
                    </pre>
                </div>

                <h3>6.2 Esquema de Tablas</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Tabla</th>
                            <th>Propósito</th>
                            <th>Campos Clave</th>
                            <th>Relaciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>profiles</strong></td>
                            <td>Perfiles de usuario del sistema</td>
                            <td>id, full_name, role</td>
                            <td>1:1 con auth.users</td>
                        </tr>
                        <tr>
                            <td><strong>patients</strong></td>
                            <td>Datos de pacientes</td>
                            <td>id, name, email, phone, medical_history</td>
                            <td>N:1 con profiles, 1:N con appointments</td>
                        </tr>
                        <tr>
                            <td><strong>appointments</strong></td>
                            <td>Citas médicas</td>
                            <td>id, patient_id, date, time, status</td>
                            <td>N:1 con patients</td>
                        </tr>
                        <tr>
                            <td><strong>consultations</strong></td>
                            <td>Consultas médicas</td>
                            <td>id, patient_id, date, diagnosis, treatment</td>
                            <td>N:1 con patients</td>
                        </tr>
                        <tr>
                            <td><strong>odontograms</strong></td>
                            <td>Odontogramas digitales</td>
                            <td>id, patient_id, chart_data</td>
                            <td>N:1 con patients</td>
                        </tr>
                        <tr>
                            <td><strong>files</strong></td>
                            <td>Archivos del paciente</td>
                            <td>id, patient_id, file_name, file_path</td>
                            <td>N:1 con patients</td>
                        </tr>
                    </tbody>
                </table>

                <h3>6.3 Políticas de Seguridad (RLS)</h3>
                <div class="code-block">
-- Política para pacientes: solo el dentista puede ver sus pacientes
CREATE POLICY "mis pacientes: leer" ON public.patients 
FOR SELECT USING (auth.uid() = dentist_id);

-- Política para citas: solo el dentista del paciente puede ver sus citas
CREATE POLICY "citas por dueño" ON public.appointments 
FOR ALL USING (EXISTS (
    SELECT 1 FROM public.patients p 
    WHERE p.id = patient_id AND p.dentist_id = auth.uid()
));

-- Política para odontogramas: solo el dentista puede acceder
CREATE POLICY "odontograma por dueño" ON public.odontograms 
FOR ALL USING (EXISTS (
    SELECT 1 FROM public.patients p 
    WHERE p.id = patient_id AND p.dentist_id = auth.uid()
));
                </div>
            </div>

            <!-- Funcionalidades -->
            <div class="section" id="funcionalidades">
                <h2>7. Funcionalidades del Sistema</h2>
                
                <h3>7.1 Módulo de Autenticación</h3>
                <ul class="feature-list">
                    <li><strong>Login/Registro:</strong> Sistema dual para dentistas y pacientes</li>
                    <li><strong>Protección de Rutas:</strong> Componente RouteGuard con verificación de roles</li>
                    <li><strong>Redirección Inteligente:</strong> Hook useRoleRedirect para navegación automática</li>
                    <li><strong>Sesiones Persistentes:</strong> Manejo automático con Supabase Auth</li>
                </ul>

                <h3>7.2 Módulo de Gestión de Pacientes</h3>
                <ul class="feature-list">
                    <li><strong>CRUD Completo:</strong> Crear, leer, actualizar y eliminar pacientes</li>
                    <li><strong>Formulario Médico:</strong> Historia clínica con 50+ campos especializados</li>
                    <li><strong>Búsqueda Avanzada:</strong> Filtros por nombre, email, teléfono</li>
                    <li><strong>Vista Detallada:</strong> Información completa con navegación por pestañas</li>
                </ul>

                <h3>7.3 Módulo de Agenda y Citas</h3>
                <ul class="feature-list">
                    <li><strong>Calendario Interactivo:</strong> Vista semanal y diaria con navegación</li>
                    <li><strong>Gestión de Horarios:</strong> Configuración de disponibilidad del dentista</li>
                    <li><strong>Estados de Cita:</strong> Programada, confirmada, completada, cancelada</li>
                    <li><strong>Recordatorios:</strong> Sistema de notificaciones automáticas</li>
                </ul>

                <h3>7.4 Módulo de Odontogramas</h3>
                <ul class="feature-list">
                    <li><strong>Odontograma Digital:</strong> Representación visual de la dentadura</li>
                    <li><strong>Herramientas de Dibujo:</strong> Marcado de dientes y tratamientos</li>
                    <li><strong>Guardado Automático:</strong> Persistencia en base de datos</li>
                    <li><strong>Exportación PDF:</strong> Generación de reportes con html2canvas y jsPDF</li>
                </ul>
            </div>

            <!-- Seguridad -->
            <div class="section" id="seguridad">
                <h2>8. Seguridad y Autenticación</h2>
                
                <h3>8.1 Arquitectura de Seguridad</h3>
                <div class="diagram">
                    <h4>Flujo de Autenticación y Autorización</h4>
                    <pre>
Usuario → Frontend → RouteGuard → Supabase Auth → JWT Token → RLS Policies → Base de Datos
   │         │           │              │            │            │              │
   │         │           │              │            │            │              │
   ▼         ▼           ▼              ▼            ▼            ▼              ▼
Credenciales → Validación → Verificación → Autenticación → Token → Autorización → Acceso
                    </pre>
                </div>

                <h3>8.2 Medidas de Seguridad Implementadas</h3>
                <ul class="feature-list">
                    <li><strong>JWT Tokens:</strong> Tokens seguros con expiración automática</li>
                    <li><strong>Row Level Security:</strong> Control granular de acceso a datos</li>
                    <li><strong>CORS Configurado:</strong> Restricción de dominios permitidos</li>
                    <li><strong>Validación de Entrada:</strong> Sanitización de datos de usuario</li>
                    <li><strong>Auditoría:</strong> Logs de acceso y modificaciones</li>
                </ul>

                <h3>8.3 Roles y Permisos</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Rol</th>
                            <th>Acceso</th>
                            <th>Funcionalidades</th>
                            <th>Restricciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Dentista</strong></td>
                            <td>Completo</td>
                            <td>Gestión de pacientes, citas, odontogramas, archivos</td>
                            <td>Solo sus pacientes</td>
                        </tr>
                        <tr>
                            <td><strong>Paciente</strong></td>
                            <td>Limitado</td>
                            <td>Ver perfil, citas propias, historial médico</td>
                            <td>Solo su información</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- API -->
            <div class="section" id="api">
                <h2>9. API y Endpoints</h2>
                
                <h3>9.1 Arquitectura de API</h3>
                <p>El sistema utiliza una arquitectura híbrida que combina:</p>
                <ul class="feature-list">
                    <li><strong>Supabase Client:</strong> Para operaciones CRUD directas</li>
                    <li><strong>Express.js Server:</strong> Para lógica de negocio compleja</li>
                    <li><strong>Autenticación:</strong> Integrada con Supabase Auth</li>
                </ul>

                <h3>9.2 Endpoints del Backend</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Método</th>
                            <th>Endpoint</th>
                            <th>Propósito</th>
                            <th>Autenticación</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>GET</td>
                            <td>/api/patients</td>
                            <td>Obtener lista de pacientes</td>
                            <td>✅ Requerida</td>
                        </tr>
                        <tr>
                            <td>POST</td>
                            <td>/api/patients</td>
                            <td>Crear nuevo paciente</td>
                            <td>✅ Requerida</td>
                        </tr>
                        <tr>
                            <td>PUT</td>
                            <td>/api/patients/:id</td>
                            <td>Actualizar paciente</td>
                            <td>✅ Requerida</td>
                        </tr>
                        <tr>
                            <td>DELETE</td>
                            <td>/api/patients/:id</td>
                            <td>Eliminar paciente</td>
                            <td>✅ Requerida</td>
                        </tr>
                        <tr>
                            <td>GET</td>
                            <td>/api/appointments</td>
                            <td>Obtener citas</td>
                            <td>✅ Requerida</td>
                        </tr>
                        <tr>
                            <td>POST</td>
                            <td>/api/appointments</td>
                            <td>Crear cita</td>
                            <td>✅ Requerida</td>
                        </tr>
                    </tbody>
                </table>

                <h3>9.3 Operaciones Supabase</h3>
                <div class="code-block">
// Ejemplo de operaciones CRUD con Supabase
const { data, error } = await supabase
  .from('patients')
  .select('*')
  .eq('dentist_id', user.id)
  .order('created_at', { ascending: false });

// Inserción con validación
const { data, error } = await supabase
  .from('patients')
  .insert([{
    name: patientData.name,
    email: patientData.email,
    dentist_id: user.id
  }])
  .select();
                </div>
            </div>

            <!-- Despliegue -->
            <div class="section" id="despliegue">
                <h2>10. Despliegue y Configuración</h2>
                
                <h3>10.1 Requisitos del Sistema</h3>
                <ul class="feature-list">
                    <li><strong>Node.js:</strong> Versión 16.0 o superior</li>
                    <li><strong>npm:</strong> Gestor de paquetes</li>
                    <li><strong>Navegador:</strong> Chrome, Firefox, Safari, Edge (versiones recientes)</li>
                    <li><strong>Responsive:</strong> Compatible con dispositivos móviles</li>
                </ul>

                <h3>10.2 Configuración de Variables de Entorno</h3>
                <div class="code-block">
# Frontend (.env)
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key

# Backend (.env)
PORT=3001
SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
NODE_ENV=development
                </div>

                <h3>10.3 Scripts de Despliegue</h3>
                <div class="code-block">
{
  "scripts": {
    "dev": "concurrently \"npm --prefix server run dev\" \"npm --prefix client run dev\"",
    "build": "npm --prefix client run build",
    "start": "npm --prefix server start"
  }
}
                </div>

                <h3>10.4 Proceso de Instalación</h3>
                <ol class="feature-list">
                    <li><strong>Clonar repositorio:</strong> git clone [url]</li>
                    <li><strong>Instalar dependencias:</strong> npm install</li>
                    <li><strong>Configurar variables de entorno:</strong> Crear archivos .env</li>
                    <li><strong>Configurar base de datos:</strong> Ejecutar migraciones Supabase</li>
                    <li><strong>Iniciar servidor:</strong> npm run dev</li>
                </ol>
            </div>
        </div>

        <div class="footer">
            <p><strong>Sistema Gestor Dental</strong> - Informe Técnico Completo</p>
            <p>Desarrollado con React, Express.js y Supabase</p>
            <p>© 2024 - Todos los derechos reservados</p>
        </div>
    </div>
</body>
</html>
